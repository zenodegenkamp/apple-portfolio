/*! @name videojs-per-source-behaviors @version 3.0.0 @license Apache-2.0 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("video.js")):"function"==typeof define&&define.amd?define(["video.js"],t):(e="undefined"!=typeof globalThis?globalThis:e||self).videojsPerSourceBehaviors=t(e.videojs)}(this,(function(e){"use strict";function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var i=t(e),s="3.0.0";const n=i.default.getTech("Html5"),r=i.default.registerPlugin||i.default.plugin,o=["abort","emptied","loadstart","play"],u=["abort","emptied"],d=["ad-playback","ads-ready?","postroll?","preroll?"],a=(e,t)=>{return!!e.usingPlugin("ads")&&((e=>e.usingPlugin("ads")&&"function"==typeof e.ads.inAdBreak)(e)?e.ads.isInAdMode()&&"loadstart"!==t.type:(i=e.ads.state,d.indexOf(i)>-1));var i},l=function(){const e=[];let t,r,d=!1,l=!0;const h=t=>function(s,n){if(this.perSourceBehaviors.disabled())return;const r=2===arguments.length,o=this.currentSrc(),u=[s],d=i.default.bind(r?this:s,arguments[arguments.length-1]),a=(...e)=>{const i=this.currentSrc()!==o;this.perSourceBehaviors.disabled()||((i||t)&&this.off(...u),i||d(...e))};return a.guid=d.guid,r||u.push(n),u.push(a),e.push(u),this.on(...u)};this.perSourceBehaviors={disable:i.default.bind(this,(function(){return this.clearTimeout(r),r=null,d=!0,d})),disabled:()=>d,enable:()=>(d=!1,d),enabled:()=>!d,isSrcStable:()=>l,VERSION:s},this.onPerSrc=h(),this.onePerSrc=h(!0),this.on("dispose",(()=>{e.length=0})),this.on(o,(i=>{if(this.perSourceBehaviors.disabled()||r||a(this,i))return;l&&u.indexOf(i.type)>-1&&(l=!1,this.trigger("sourceunstable"));const s=[],o=e=>s.push({time:Date.now(),event:e});o(i),this.on(n.Events,o),r=this.setTimeout((()=>{const i=this.currentSrc();l=!0,r=null,this.off(n.Events,o),i&&i!==t&&(e.forEach((e=>this.off(...e))),e.length=0,this.trigger("sourcechanged",{interimEvents:s,from:t,to:i}),t=i)}),1)}))};return l.VERSION=s,r("perSourceBehaviors",l),l}));
